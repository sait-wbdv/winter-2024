---
title: Supabase - Site Integration
excerpt:
status: announced
---

<script>
	import Homework from "$lib/components/Homework.svelte";
	import LessonPlan from "$lib/components/LessonPlan.svelte";
	import Achievement from "$lib/components/Achievement.svelte";
</script>

<Homework {status}>

### Watch list

</Homework>

<LessonPlan {status}>

<h2> Morning Javascript Review: Destructuring Assignment</h2>

- Destructuring is when you see things like:

```
const { a, b, ...rest } = objectWithPropertiesAnB;
const [firstVal, secondVal] = arrayOfAtLeastTwoItems;

```

- note the use of the spread operator, this will aggregate all the rest of the values not specified

### Materials

- Video: [Web Dev Simplified](https://www.youtube.com/watch?v=NIq3qLaHCIs)
- MDN: [Destructuring assignment](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)

### Activity: Practice Destructuring

- Using the tables and json we made yesterday, create 2 or more arrays and 2 or more objects
- experiment with the following:

  1. extract variables from an array: Destructuring arrays `[a,b] = arrWithAB`
  2. destructure output from function
     - ```
       function sumAndMultiply(a,b) {
         return [a+b, a*b]
       }
       ```

  ````
  - then assign those functions with destructuring
  3. Using your objects, assign values with destructuring: `{firstName, lastName, ...rest} = userOne;`
  4. Combine two objects with destructuring
  5. Destructure the return of a function
  6. Destructure function arguments
    - ```
    function returnInfo({name, age}) {
      console.log(`${name} is ${age} years old)
    };
    // then call the function
    returnInfo(personOne)

     ```
  ````

---

<h2>Getting Started with Supabase</h2>

[![Slides - Supabase with Sveltekit](/images/slides/cpnt-200/supabase-sveltekit.png)](/slides/cpnt-200/supabase-introduction)

<h2>Filtering and modifying data In Supabase</h2>

### Materials

- [Fetching data](https://supabase.com/docs/reference/javascript/select)
- [Using filters](https://supabase.com/docs/reference/javascript/using-filters)
- [Using Modifiers](https://supabase.com/docs/reference/javascript/db-modifiers-select)

**Supabase Tips**

- [match](https://www.youtube.com/watch?v=Jx8unDjLaKg)
- [count](https://www.youtube.com/watch?v=51ChVycS__k)
- [How to use textSearch to perform full text search](https://www.youtube.com/watch?v=b-mgca_2Oe4)
- [How to retrieve a One to Many relationship with SupabaseJS](https://www.youtube.com/watch?v=_GQJa3xAfJ4)

### Helpful Videos

- [One to one relationships in Supabase](https://youtu.be/j31N0cWPvi8?si=wA2zHBdIeA8xj2C-)
- [One to many relationships in Supabase](https://youtu.be/5VrF9OVQ6rg?si=_DsgONDa5U_0Syi7)

<h2> 2. Demo: RLS and Policies</h2>

<dl>
	<dt>RLS</dt>
	<dd>Row-level Security is PostgreSQL's (the database engine used by Supabase) method of auth for each row of a database table.</dd>
	<dt>Access Policies</dt>
	<dd>PostgreSQL's method of allowing access to each row in a database table.</dd>
</dl>

### Instructions

1. Open Postman in the browser and sign-in;
2. In Supabase, go to API Docs &rarr; `counties` and scroll down to `Insert rows` or `Update` rows;
3. In the top right column click `Bash`;
4. Copy the command you want to use;
5. Paste this into the Address field in Postman and:
   - change the URL to `https://szwovebnfgeezuwjnmyz.supabase.co/rest/v1/countries`
   - if "updating", change `some_column` to `name` and `eq.someValue` to `eq.Canada` (or similar);
   - under Headers copy/past the apiKey you Instructor pasted in the Zoom chat where it says SUPABASE_KEY
   - under body: change JSON to match the column and value that you want to change/insert;
6. Press SEND!

### Key Takeaways

- If RLS is disabled on a table, anyone can read/write/edit records in the table.
- Once RLS is enabled on a table, _no one_ can read/write/edit records in a table.
- A Policy is required on RLS-enabled tables before anyone can read/write/edit records in a table.

It this course we will _enable_ RLS and set Policies so that anyone with an `<anon>` token can read a table but no one can write or edit a table unless they are using the admin panel.

---

<h2> 2. Authentication vs Authorization</h2>

[![Slides - Authentication vs Authorization](/images/slides/authentication-vs-authorization.png)](https://sait-wbdv.github.io/slides/w23/cpnt-200/authentication-authorization.html)

### Materials

- [Part One: JWTs](https://supabase.com/docs/learn/auth-deep-dive/auth-deep-dive-jwts)
- [Part Two: Row Level Security](https://supabase.com/docs/learn/auth-deep-dive/auth-row-level-security)
- [Part Three: Policies](https://supabase.com/docs/learn/auth-deep-dive/auth-policies)

### Key Takaways

- In _Supabase_: - Authentication happens first with the `<anon>` `apiKey` token. - Authorization happens second with the `Authorization` Bearer token.
- Even if RLS is _Disabled_, users still need an `<anon>` API key to read or make changes to a database table.

</LessonPlan>

<Achievement {status}>

</Achievement>
